<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>상세보기 페이지</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
          crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=92vw1jqd4q"></script>
  <style>
    #map1 {
      width: 100%;
      height: 200px;
    }
    #map2 {
      width: 100%;
      height: 500px;
    }
    #left-remote {
      position: fixed;
      top: 30px;
      width: 220px;
    }
    
    #right-remote {
      position: fixed;
      top: 30px;
      right: 15%;
      width: 220px;
      
    }
    </style>
  
  <script>
    $(document).ready(function () {
      var mapOptions = {
        center: new naver.maps.LatLng(37.3595704, 127.105399),
        zoom: 10
      }
  
      var map1 = new naver.maps.Map('map1', mapOptions);
  
      var marker = new naver.maps.Marker({
        position: new naver.maps.LatLng(37.3595704, 127.105399),
        map: map1
      });
  
      // var mapOptions2 = {
      //   center: new naver.maps.LatLng(37.3595704, 127.105399),
      //   zoom: 20
      // }
      // var map2 = naver.maps.Map('map2', mapOptions2);
      //
      // var marker2 = new naver.maps.Marker({
      //   position: new naver.maps.LatLng(37.3595704, 127.105399),
      //   map: map2
      // });
      
      
      $("#btn-follow").on('click', function () {
        const ceoStore = $("#ceoStore").val();
        const customerIdx = $("#customerIdx").val();
  
        $.ajax({
          url: "/bmn/updateFollow",
          type: "PUT",
          data: {ceoStore: ceoStore, customerIdx: customerIdx},
          success: function (data) {
            if (data != null) {
              alert(data);
            }
          },
          error: function () {
            alert("ajax 통신 중 오류 발생");
          }
        });

      });
      
    })
  </script>
</head>
<body>
  <header></header>
  
  <main>
    <div class="container" id="container">
      <div class="row">
        <!--        왼쪽 리모컨-->
        <div class="col-sm-2 d-grid" id="left-remote">
<!--          지도-->
          <div class="border my-2" data-bs-toggle="modal" data-bs-target="#map-modal" id="map1"></div>
          <a href="#" class="btn btn-secondary my-2">예약하기</a>
          <div class="border rounded-2 p-2">예약정보 구역</div>
        </div>
        <div class="col-sm-8">
        </div>
        <!--        오른쪽 리모컨-->
        <div class="col-sm-2" id="right-remote">
          <div class="border rounded-2 text-center d-flex flex-column my-2">
            <a href="#" class="my-2"><i class="bi bi-arrow-up-circle-fill" style="font-size: 20px; color: tomato"></i></a>
            <a href="#" class="mb-2"><i class="bi bi-arrow-down-circle-fill"
                                        style="font-size: 20px; color: tomato"></i></a>
            <a class="btn mb-2">로그인</a>
            <div></div>
            <a class="btn mb-2">로그아웃</a>
            <a class="btn mb-2">리뷰 쓰기</a>
          </div>
        </div>
      </div>
    
      <div class="row my-4">
        <div class="col-sm-8 mx-auto">
          <div class="border rounded-2 p-2">
            <p th:text="${ceoDto.ceoStore}" class="fw-bold fs-2">가게 이름</p>
            <p th:text="${ceoDto.ceoCategoryM}" class="text-muted">카테고리</p>
            <p th:text="|평점 : ${ceoDto.ceoScore}점|"></p>
            <div class="row">
              <div class="col-sm">
                <button class="btn btn-primary m-3" id="btn-follow">#팔로우
                  <span th:text="${followCnt}" id="follow-cnt">3</span>
                </button>
                <input type="hidden" id="ceoStore" th:value="${ceoDto.ceoStore}">
                <input type="hidden" id="customerIdx" th:value="${session.customerIdx}">
              </div>
              <div class="col-sm d-flex justify-content-end">
                <button class="btn btn-outline-success m-3">#리뷰작성</button>
              </div>
            </div>
          </div>
          <div class="border rounded-2 my-3 p-2">
            <p th:text="|가게명 : ${ceoDto.ceoStore}|">가게이름</p>
            <p th:text="|시군구 : ${ceoDto.ceoCityAddress}|"></p>
            <p th:text="|주소 : ${ceoDto.ceoFullAddress}|">주소</p>
            <p th:text="|대표메뉴 : ${ceoDto.ceoMainMenu}|">대표메뉴</p>
            <div class="row">
              <div class="col-sm-4">
                <div class="card" style="width: 40rem;">
                  <img th:src="${ceoDto.ceoMenuImg}" class="card-img-top" alt="등록된 이미지가 없습니다.">
                  <div class="card-body">
                    <h5 class="card-title" th:text="|${ceoDto.ceoMainMenu}|">Card title</h5>
                  </div>
                </div>
                
              </div>
            </div>
            <p th:text="${ceoDto.ceoDetailMenu}">상세메뉴</p>
            <p th:text="|식당 소개글 : ${ceoDto.ceoContents}|">매장소개</p>
            <p th:text="|영업시간 : ${ceoDto.ceoOpenTime}|">영업시간</p>
            <p th:text="|연락처 : ${ceoDto.ceoCallNumber}|">전화번호</p>
          </div>
          <div class="my-5">
            <h4 class="fw-bold">#방문자 리뷰</h4>
            <hr>
            <p th:text="|${ceoDto.ceoScore}점|"></p>
            <div th:if="${#lists.size(reviewList)} > 0" th:each="item : ${reviewList}" class="border rounded-3">
              <p th:text=""></p>
            </div>
            <div th:unless="${#lists.size(reviewList)} > 0" th:each="item : ${reviewList}" class="border rounded-3">
              <p>등록된 리뷰가 없습니다.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    
    <!--          모달 팝업 지도창-->
    <div class="modal" id="map-modal">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">지도 확대하기</h4>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div id="map2"></div>
          </div>
        </div>
      </div>
    </div>
  </main>

  
  <footer></footer>

  <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
</body>
</html>